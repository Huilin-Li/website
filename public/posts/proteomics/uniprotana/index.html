<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="We can reveal these information.
To minimize duplications between the UniProt Swiss-Prot database and the PDB database, I focused on downloading the structures of 513,805 entries from UniProt (Swiss-Prot) that are only available in the Alphafold Protein Structure Database. Therefore, I only need to download 4,274 entries&rsquo; structures, because the remaining 509,531 entries&rsquo; structures can be directly extracted from (Fig.2).{&#39;AFDB&#39;: &#39;hasAFDB&#39;,&#39;PDB&#39;: &#39;no&#39;,&#39;annotationScore&#39;: 1.0,&#39;comments&#39;: nan,&#39;entryAudit&#39;: &#34;{&#39;firstPublicDate&#39;: &#39;1988-08-01&#39;, &#39;lastAnnotationUpdateDate&#39;: &#34;&#34;&#39;2022-05-25&#39;, &#39;lastSequenceUpdateDate&#39;: &#39;1988-08-01&#39;, &#34;&#34;&#39;entryVersion&#39;: 36, &#39;sequenceVersion&#39;: 1}&#34;,&#39;entryType&#39;: &#39;UniProtKB reviewed (Swiss-Prot)&#39;,&#39;extraAttributes&#39;: &#34;{&#39;countByFeatureType&#39;: {&#39;Chain&#39;: 1}, &#39;uniParcId&#39;: &#34;&#34;&#39;UPI000013C2E9&#39;}&#34;,&#39;features&#39;: &#34;[{&#39;type&#39;: &#39;Chain&#39;, &#39;location&#39;: {&#39;start&#39;: {&#39;value&#39;: 1, &#34;&#34;&#39;modifier&#39;: &#39;EXACT&#39;}, &#39;end&#39;: {&#39;value&#39;: 79, &#39;modifier&#39;: &#34;&#34;&#39;EXACT&#39;}}, &#39;description&#39;: &#39;Putative uncharacterized protein Z&#39;, &#34;&#34;&#39;featureId&#39;: &#39;PRO_0000066556&#39;}]&#34;,&#39;geneLocations&#39;: nan,&#39;genes&#39;: nan,&#39;index&#39;: 860,&#39;keywords&#39;: &#34;[{&#39;id&#39;: &#39;KW-1185&#39;, &#39;category&#39;: &#39;Technical term&#39;, &#39;name&#39;: &#34;&#34;&#39;Reference proteome&#39;}]&#34;,&#39;organism&#39;: &#34;{&#39;scientificName&#39;: &#39;Ovis aries&#39;, &#39;commonName&#39;: &#39;Sheep&#39;, &#34;&#34;&#39;taxonId&#39;: 9940, &#39;lineage&#39;: [&#39;Eukaryota&#39;, &#39;Metazoa&#39;, &#39;Chordata&#39;, &#34;&#34;&#39;Craniata&#39;, &#39;Vertebrata&#39;, &#39;Euteleostomi&#39;, &#39;Mammalia&#39;, &#34;&#34;&#39;Eutheria&#39;, &#39;Laurasiatheria&#39;, &#39;Artiodactyla&#39;, &#39;Ruminantia&#39;, &#34;&#34;&#39;Pecora&#39;, &#39;Bovidae&#39;, &#39;Caprinae&#39;, &#39;Ovis&#39;]}&#34;,&#39;organismHosts&#39;: nan,&#39;primaryAccession&#39;: &#39;P08105&#39;,&#39;proteinDescription&#39;: &#34;{&#39;recommendedName&#39;: {&#39;fullName&#39;: {&#39;value&#39;: &#39;Putative &#34;&#34;uncharacterized protein Z&#39;}}}&#34;,&#39;proteinExistence&#39;: &#39;4: Predicted&#39;,&#39;references&#39;: &#34;[{&#39;referenceNumber&#39;: 1, &#39;citation&#39;: {&#39;id&#39;: &#39;6193483&#39;, &#34;&#34;&#39;citationType&#39;: &#39;journal article&#39;, &#39;authors&#39;: [&#39;Powell B.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="use unipressed.UniprotkbClient analysis UniProt(Swiss-Prot) DB" />
<meta property="og:description" content="We can reveal these information.
To minimize duplications between the UniProt Swiss-Prot database and the PDB database, I focused on downloading the structures of 513,805 entries from UniProt (Swiss-Prot) that are only available in the Alphafold Protein Structure Database. Therefore, I only need to download 4,274 entries&rsquo; structures, because the remaining 509,531 entries&rsquo; structures can be directly extracted from (Fig.2).{&#39;AFDB&#39;: &#39;hasAFDB&#39;,&#39;PDB&#39;: &#39;no&#39;,&#39;annotationScore&#39;: 1.0,&#39;comments&#39;: nan,&#39;entryAudit&#39;: &#34;{&#39;firstPublicDate&#39;: &#39;1988-08-01&#39;, &#39;lastAnnotationUpdateDate&#39;: &#34;&#34;&#39;2022-05-25&#39;, &#39;lastSequenceUpdateDate&#39;: &#39;1988-08-01&#39;, &#34;&#34;&#39;entryVersion&#39;: 36, &#39;sequenceVersion&#39;: 1}&#34;,&#39;entryType&#39;: &#39;UniProtKB reviewed (Swiss-Prot)&#39;,&#39;extraAttributes&#39;: &#34;{&#39;countByFeatureType&#39;: {&#39;Chain&#39;: 1}, &#39;uniParcId&#39;: &#34;&#34;&#39;UPI000013C2E9&#39;}&#34;,&#39;features&#39;: &#34;[{&#39;type&#39;: &#39;Chain&#39;, &#39;location&#39;: {&#39;start&#39;: {&#39;value&#39;: 1, &#34;&#34;&#39;modifier&#39;: &#39;EXACT&#39;}, &#39;end&#39;: {&#39;value&#39;: 79, &#39;modifier&#39;: &#34;&#34;&#39;EXACT&#39;}}, &#39;description&#39;: &#39;Putative uncharacterized protein Z&#39;, &#34;&#34;&#39;featureId&#39;: &#39;PRO_0000066556&#39;}]&#34;,&#39;geneLocations&#39;: nan,&#39;genes&#39;: nan,&#39;index&#39;: 860,&#39;keywords&#39;: &#34;[{&#39;id&#39;: &#39;KW-1185&#39;, &#39;category&#39;: &#39;Technical term&#39;, &#39;name&#39;: &#34;&#34;&#39;Reference proteome&#39;}]&#34;,&#39;organism&#39;: &#34;{&#39;scientificName&#39;: &#39;Ovis aries&#39;, &#39;commonName&#39;: &#39;Sheep&#39;, &#34;&#34;&#39;taxonId&#39;: 9940, &#39;lineage&#39;: [&#39;Eukaryota&#39;, &#39;Metazoa&#39;, &#39;Chordata&#39;, &#34;&#34;&#39;Craniata&#39;, &#39;Vertebrata&#39;, &#39;Euteleostomi&#39;, &#39;Mammalia&#39;, &#34;&#34;&#39;Eutheria&#39;, &#39;Laurasiatheria&#39;, &#39;Artiodactyla&#39;, &#39;Ruminantia&#39;, &#34;&#34;&#39;Pecora&#39;, &#39;Bovidae&#39;, &#39;Caprinae&#39;, &#39;Ovis&#39;]}&#34;,&#39;organismHosts&#39;: nan,&#39;primaryAccession&#39;: &#39;P08105&#39;,&#39;proteinDescription&#39;: &#34;{&#39;recommendedName&#39;: {&#39;fullName&#39;: {&#39;value&#39;: &#39;Putative &#34;&#34;uncharacterized protein Z&#39;}}}&#34;,&#39;proteinExistence&#39;: &#39;4: Predicted&#39;,&#39;references&#39;: &#34;[{&#39;referenceNumber&#39;: 1, &#39;citation&#39;: {&#39;id&#39;: &#39;6193483&#39;, &#34;&#34;&#39;citationType&#39;: &#39;journal article&#39;, &#39;authors&#39;: [&#39;Powell B." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/proteomics/uniprotana/" /><meta property="article:section" content="posts" />



<title>use unipressed.UniprotkbClient analysis UniProt(Swiss-Prot) DB | Huilin Li</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/logo.png" >
<link rel="canonical" href="http://localhost:1313/posts/proteomics/uniprotana/">
<link rel="stylesheet" href="/book.min.f3de075a26891530cb4ae6aeb9b647bcc541281bbd3ec57e8bf60cb157bc209f.css" integrity="sha256-894HWiaJFTDLSuauubZHvMVBKBu9PsV&#43;i/YMsVe8IJ8=" crossorigin="anonymous">
  <script defer src="/flexsearch.min.js"></script>
  <script defer src="/en.search.min.5b52b6eb6f61a724ac69c15b883864af2d930cf4c99eb8c92f0b1349a8daeda6.js" integrity="sha256-W1K2629hpySsacFbiDhkry2TDPTJnrjJLwsTSaja7aY=" crossorigin="anonymous"></script>

  <script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" integrity="sha256-b2&#43;Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC&#43;NdcPIvZhzk=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>Huilin Li</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  



  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-bc4d9392f5af16481cccf0c311076888" class="toggle"  />
    <label for="section-bc4d9392f5af16481cccf0c311076888" class="flex justify-between">
      <a role="button" class="">Project</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-6b2297e97d707e7ee14411430da62d58" class="toggle"  />
    <label for="section-6b2297e97d707e7ee14411430da62d58" class="flex justify-between">
      <a role="button" class="">Binder Design</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/project/binderdesign/truncation/" class="">truncation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/project/binderdesign/design/" class="">design binders via RFdiffusion and ProteinMPNN-FastRelax</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/project/binderdesign/pae_score/" class="">pae_interaction score</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/project/binderdesign/filtering/" class="">backbones filtering</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/project/binderdesign/notes/" class="">notes</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>











  
<ul>
  
  <li>
    <a href="/posts/ml/"  >
        Algorithms
      </a>
  </li>
  
  <li>
    <a href="/posts/proteomics/"  >
        Proteomics
      </a>
  </li>
  
  <li>
    <a href="/posts/blog/"  >
        Blog
      </a>
  </li>
  
  <li>
    <a href="https://github.com/Huilin-Li"  target="_blank" rel="noopener">
        Github
      </a>
  </li>
  
  <li>
    <a href="/links/"  >
        World
      </a>
  </li>
  
  <li>
    <a href="/tools/"  >
        Contact
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>use unipressed.UniprotkbClient analysis UniProt(Swiss-Prot) DB</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents"></nav>



  </aside>
  
 
      </header>

      
      
<article class="markdown book-post">
  <h1>
    <a href="/posts/proteomics/uniprotana/">use unipressed.UniprotkbClient analysis UniProt(Swiss-Prot) DB</a>
  </h1>
  


  

  



<p>We can reveal these information.</p>
<blockquote class="book-hint warning">
  To minimize duplications between the UniProt Swiss-Prot database and the PDB database, I focused on downloading the structures of 513,805 entries from UniProt (Swiss-Prot) that are only available in the Alphafold Protein Structure Database. Therefore, I only need to download 4,274 entries&rsquo; structures, because the remaining 509,531 entries&rsquo; structures can be directly extracted from (Fig.2).
</blockquote>

<pre tabindex="0"><code>{&#39;AFDB&#39;: &#39;hasAFDB&#39;,
 &#39;PDB&#39;: &#39;no&#39;,
 &#39;annotationScore&#39;: 1.0,
 &#39;comments&#39;: nan,
 &#39;entryAudit&#39;: &#34;{&#39;firstPublicDate&#39;: &#39;1988-08-01&#39;, &#39;lastAnnotationUpdateDate&#39;: &#34;
               &#34;&#39;2022-05-25&#39;, &#39;lastSequenceUpdateDate&#39;: &#39;1988-08-01&#39;, &#34;
               &#34;&#39;entryVersion&#39;: 36, &#39;sequenceVersion&#39;: 1}&#34;,
 &#39;entryType&#39;: &#39;UniProtKB reviewed (Swiss-Prot)&#39;,
 &#39;extraAttributes&#39;: &#34;{&#39;countByFeatureType&#39;: {&#39;Chain&#39;: 1}, &#39;uniParcId&#39;: &#34;
                    &#34;&#39;UPI000013C2E9&#39;}&#34;,
 &#39;features&#39;: &#34;[{&#39;type&#39;: &#39;Chain&#39;, &#39;location&#39;: {&#39;start&#39;: {&#39;value&#39;: 1, &#34;
             &#34;&#39;modifier&#39;: &#39;EXACT&#39;}, &#39;end&#39;: {&#39;value&#39;: 79, &#39;modifier&#39;: &#34;
             &#34;&#39;EXACT&#39;}}, &#39;description&#39;: &#39;Putative uncharacterized protein Z&#39;, &#34;
             &#34;&#39;featureId&#39;: &#39;PRO_0000066556&#39;}]&#34;,
 &#39;geneLocations&#39;: nan,
 &#39;genes&#39;: nan,
 &#39;index&#39;: 860,
 &#39;keywords&#39;: &#34;[{&#39;id&#39;: &#39;KW-1185&#39;, &#39;category&#39;: &#39;Technical term&#39;, &#39;name&#39;: &#34;
             &#34;&#39;Reference proteome&#39;}]&#34;,
 &#39;organism&#39;: &#34;{&#39;scientificName&#39;: &#39;Ovis aries&#39;, &#39;commonName&#39;: &#39;Sheep&#39;, &#34;
             &#34;&#39;taxonId&#39;: 9940, &#39;lineage&#39;: [&#39;Eukaryota&#39;, &#39;Metazoa&#39;, &#39;Chordata&#39;, &#34;
             &#34;&#39;Craniata&#39;, &#39;Vertebrata&#39;, &#39;Euteleostomi&#39;, &#39;Mammalia&#39;, &#34;
             &#34;&#39;Eutheria&#39;, &#39;Laurasiatheria&#39;, &#39;Artiodactyla&#39;, &#39;Ruminantia&#39;, &#34;
             &#34;&#39;Pecora&#39;, &#39;Bovidae&#39;, &#39;Caprinae&#39;, &#39;Ovis&#39;]}&#34;,
 &#39;organismHosts&#39;: nan,
 &#39;primaryAccession&#39;: &#39;P08105&#39;,
 &#39;proteinDescription&#39;: &#34;{&#39;recommendedName&#39;: {&#39;fullName&#39;: {&#39;value&#39;: &#39;Putative &#34;
                       &#34;uncharacterized protein Z&#39;}}}&#34;,
 &#39;proteinExistence&#39;: &#39;4: Predicted&#39;,
 &#39;references&#39;: &#34;[{&#39;referenceNumber&#39;: 1, &#39;citation&#39;: {&#39;id&#39;: &#39;6193483&#39;, &#34;
               &#34;&#39;citationType&#39;: &#39;journal article&#39;, &#39;authors&#39;: [&#39;Powell B.C.&#39;, &#34;
               &#34;&#39;Sleigh M.J.&#39;, &#39;Ward K.A.&#39;, &#39;Rogers G.E.&#39;], &#34;
               &#34;&#39;citationCrossReferences&#39;: [{&#39;database&#39;: &#39;PubMed&#39;, &#39;id&#39;: &#34;
               &#34;&#39;6193483&#39;}, {&#39;database&#39;: &#39;DOI&#39;, &#39;id&#39;: &#34;
               &#34;&#39;10.1093/nar/11.16.5327&#39;}], &#39;title&#39;: &#39;Mammalian keratin gene &#34;
               &#39;families: organisation of genes coding for the B2 high-sulphur &#39;
               &#34;proteins of sheep wool.&#39;, &#39;publicationDate&#39;: &#39;1983&#39;, &#34;
               &#34;&#39;journal&#39;: &#39;Nucleic Acids Res.&#39;, &#39;firstPage&#39;: &#39;5327&#39;, &#34;
               &#34;&#39;lastPage&#39;: &#39;5346&#39;, &#39;volume&#39;: &#39;11&#39;}, &#39;referencePositions&#39;: &#34;
               &#34;[&#39;NUCLEOTIDE SEQUENCE [GENOMIC DNA]&#39;]}]&#34;,
 &#39;secondaryAccessions&#39;: nan,
 &#39;sequence&#39;: &#34;{&#39;value&#39;: &#34;
             &#34;&#39;MSSSLEITSFYSFIWTPHIGPLLFGIGLWFSMFKEPSHFCPCQHPHFVEVVIPCDSLSRSLRLRVIVLFLAIFFPLLNI&#39;, &#34;
             &#34;&#39;length&#39;: 79, &#39;molWeight&#39;: 9128, &#39;crc64&#39;: &#39;A663EB489F6290C3&#39;, &#34;
             &#34;&#39;md5&#39;: &#39;80A5E20AFD024495655E6A9FA7B6166B&#39;}&#34;,
 &#39;uniProtKBCrossReferences&#39;: &#34;[{&#39;database&#39;: &#39;EMBL&#39;, &#39;id&#39;: &#39;X01610&#39;, &#34;
                             &#34;&#39;properties&#39;: [{&#39;key&#39;: &#39;ProteinId&#39;, &#39;value&#39;: &#34;
                             &#34;&#39;CAA25758.1&#39;}, {&#39;key&#39;: &#39;Status&#39;, &#39;value&#39;: &#39;-&#39;}, &#34;
                             &#34;{&#39;key&#39;: &#39;MoleculeType&#39;, &#39;value&#39;: &#34;
                             &#34;&#39;Genomic_DNA&#39;}]}, {&#39;database&#39;: &#39;PIR&#39;, &#39;id&#39;: &#34;
                             &#34;&#39;S07912&#39;, &#39;properties&#39;: [{&#39;key&#39;: &#39;EntryName&#39;, &#34;
                             &#34;&#39;value&#39;: &#39;S07912&#39;}]}, {&#39;database&#39;: &#34;
                             &#34;&#39;AlphaFoldDB&#39;, &#39;id&#39;: &#39;P08105&#39;, &#39;properties&#39;: &#34;
                             &#34;[{&#39;key&#39;: &#39;Description&#39;, &#39;value&#39;: &#39;-&#39;}]}, &#34;
                             &#34;{&#39;database&#39;: &#39;Proteomes&#39;, &#39;id&#39;: &#39;UP000002356&#39;, &#34;
                             &#34;&#39;properties&#39;: [{&#39;key&#39;: &#39;Component&#39;, &#39;value&#39;: &#34;
                             &#34;&#39;Unplaced&#39;}]}]&#34;,
 &#39;uniProtkbId&#39;: &#39;Z_SHEEP&#39;}
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> unipressed <span style="color:#f92672">import</span> UniprotkbClient
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Entries in Uniprot(Swiss-Prot)</span>
</span></span><span style="display:flex;"><span>uniprot_sp_entries_txt <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#34;/path/uniprot_sprot.fasta/SwissProt_entries.txt&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>)
</span></span><span style="display:flex;"><span>uniprot_sp_entries <span style="color:#f92672">=</span> uniprot_sp_entries_txt<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>print(len(uniprot_sp_entries), uniprot_sp_entries[<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>:])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Split the whole entries in Uniprot(Swiss-Prot) into some chunks with the size of 1000</span>
</span></span><span style="display:flex;"><span>chunks <span style="color:#f92672">=</span> [uniprot_sp_entries[x:x<span style="color:#f92672">+</span><span style="color:#ae81ff">1000</span>] <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(uniprot_sp_entries), <span style="color:#ae81ff">1000</span>)]
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;We have &#34;</span>, len(chunks), <span style="color:#e6db74">&#34; chunks, and the last chunk has &#34;</span>, len(chunks[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]),<span style="color:#e6db74">&#34; entries.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># analyze using unipressed</span>
</span></span><span style="display:flex;"><span>no_uniProtKBCrossReferences_list <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>no_uniProtKBCrossReferences_count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(chunks)):
</span></span><span style="display:flex;"><span>    print(i, end<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;: &#34;</span>)
</span></span><span style="display:flex;"><span>    chunk <span style="color:#f92672">=</span> chunks[i]
</span></span><span style="display:flex;"><span>    db_dic <span style="color:#f92672">=</span> UniprotkbClient<span style="color:#f92672">.</span>fetch_many(chunk)
</span></span><span style="display:flex;"><span>    df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(db_dic)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;chunk size is &#34;</span>, len(df), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;; &#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># no_uniProtKBCrossReferences list and count</span>
</span></span><span style="display:flex;"><span>    no_uniProtKBCrossReferences_primaryAccession_list <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;uniProtKBCrossReferences&#34;</span>]<span style="color:#f92672">.</span>isna()][<span style="color:#e6db74">&#34;primaryAccession&#34;</span>]<span style="color:#f92672">.</span>tolist()
</span></span><span style="display:flex;"><span>    no_uniProtKBCrossReferences_list<span style="color:#f92672">.</span>extend(no_uniProtKBCrossReferences_primaryAccession_list)
</span></span><span style="display:flex;"><span>    no_uniProtKBCrossReferences_count <span style="color:#f92672">=</span> no_uniProtKBCrossReferences_count <span style="color:#f92672">+</span> len(no_uniProtKBCrossReferences_primaryAccession_list)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;no_uniProtKBCrossReferences_count is &#34;</span>, no_uniProtKBCrossReferences_count)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># has uniProtKBCrossReferences df</span>
</span></span><span style="display:flex;"><span>    db_df <span style="color:#f92672">=</span> df[<span style="color:#f92672">~</span>df[<span style="color:#e6db74">&#34;uniProtKBCrossReferences&#34;</span>]<span style="color:#f92672">.</span>isna()]
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># has PDB structure or has AFDB structure</span>
</span></span><span style="display:flex;"><span>    db_df<span style="color:#f92672">.</span>loc[:,[<span style="color:#e6db74">&#34;PDB&#34;</span>]] <span style="color:#f92672">=</span> db_df[<span style="color:#e6db74">&#34;uniProtKBCrossReferences&#34;</span>]<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: <span style="color:#e6db74">&#34;hasPDB&#34;</span> <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;PDB&#34;</span> <span style="color:#f92672">in</span> pd<span style="color:#f92672">.</span>DataFrame(x)[<span style="color:#e6db74">&#34;database&#34;</span>]<span style="color:#f92672">.</span>tolist() <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#34;no&#34;</span>)
</span></span><span style="display:flex;"><span>    db_df<span style="color:#f92672">.</span>loc[:,[<span style="color:#e6db74">&#34;AFDB&#34;</span>]] <span style="color:#f92672">=</span> db_df[<span style="color:#e6db74">&#34;uniProtKBCrossReferences&#34;</span>]<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: <span style="color:#e6db74">&#34;hasAFDB&#34;</span> <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;AlphaFoldDB&#34;</span> <span style="color:#f92672">in</span> pd<span style="color:#f92672">.</span>DataFrame(x)[<span style="color:#e6db74">&#34;database&#34;</span>]<span style="color:#f92672">.</span>tolist() <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#34;no&#34;</span>)
</span></span><span style="display:flex;"><span>    db_df<span style="color:#f92672">.</span>to_csv(<span style="color:#e6db74">&#34;/path/UniprotkbClient_results/db_df_&#34;</span><span style="color:#f92672">+</span>str(i)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.csv&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># write no_uniProtKBCrossReferences_list to txt file</span>
</span></span><span style="display:flex;"><span>no_uniProtKBCrossReferences_file <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#34;/path/UniprotkbClient_results/no_uniProtKBCrossReferences_entries.txt&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> no_uniProtKBCrossReferences_list:
</span></span><span style="display:flex;"><span>    no_uniProtKBCrossReferences_file<span style="color:#f92672">.</span>write(line<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>no_uniProtKBCrossReferences_file<span style="color:#f92672">.</span>close()
</span></span></code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments"><script src="https://giscus.app/client.js"
        data-repo="Huilin-Li/site-comment"
        data-repo-id="R_kgDOL3ovHA"
        data-category="General"
        data-category-id="DIC_kwDOL3ovHM4CfKps"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script></div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents"></nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












