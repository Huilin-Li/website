[{"id":0,"href":"/docs/blogs/bioworld/","title":"Biology World","section":"Blog","content":"\rBiology World\r#\rAstrobiology, NASA.\n{{ \u0026lt;ipynb \u0026ldquo;preprocessing.ipynb\u0026rdquo;\u0026gt; }}\nClick here to view this notebook in full screen\r"},{"id":1,"href":"/docs/blogs/hugo/hugobookgithubaction/","title":"HugoBook+GithubAction","section":"Hugo","content":"\rIn Windows10, build personal website via Hugo-book and Github Actions\r#\rThis blog is about how to use Hugo to create the local website, and then deploy it on GitHub via Github Action. Everything is step by step.\nPrerequisites\r#\rGit Windows 10 VScode Github account Install Hugo\r#\rIn Windows10, right click Windows Powershell and click run as administrator. Refer to How to install chocolatey in Windows to install chocolatey. Refer to Install Hugo on Windows to install Hugo by choco install hugo-extended Make sure Hugo works well by hugo version and we will get the following\nhugo v0.123.7-312735366b20d64bd61bff8627f593749f86c964+extended windows/amd64 BuildDate=2024-03-01T16:16:06Z VendorInfo=gohugoio Create the website using Hugo themes\r#\rFor example, I want to locally work on my website in C:\\myweb folder. Still in Windows Powershell,\nNavigate back to C: driver, and create a new folder by typing mkdir myweb. Create the website by hugo new site Blogs cd Blogs git init Refer to Hugo Book Theme to use hugo-book theme by git submodule add https://github.com/alex-shpak/hugo-book themes/hugo-book Till now, if we run hugo server, we will get a plain website locally. In VS code, open Blogs folder.\nIn C:/myweb/Blogs/themes/hugo-book/exampleSite/content.en/, copy docs folder, posts folder and _index.md file to C:/myweb/Blogs/content/. Why I don\u0026rsquo;t copy the menu folder?\nBecause I found menu folder doesn\u0026rsquo;t work when I modified the website as I needed. We can customize the order of menus in leftbar by adding weight in the name.md file. For example, in each name.md file, the parameter weight determine the order of menues.\n---\rweight: 1\rtitle: One name.md file\r--- Run hugo server again, we will see a more well-done website. Deploy on Github by Action\r#\rCreate a public Github repository. For example, if this repository\u0026rsquo;s name is Blogs, your website link will be like this https://huilin-li.github.io/Blogs/\nStill in Windows Powershell, push your local work to this repository by cd C:/myweb/Blogs\rgit add .\rgit commit -m \u0026#34;update\u0026#34;\rgit branch -M main\rgit remote add origin https://github.com/Huilin-Li/Blogs.git\rgit push -u origin main Visit your GitHub repository. From the main menu choose Settings \u0026gt; Pages. In the center of your screen you will see this: Change the Source to GitHub Actions. Click Configure as the highlight in this picture: Go to Host on GitHub Pages, copy the yaml file in step 6 to Blogs/.github/workflows/hugo.yaml, and commit changes. As Step8, Step9, Step10 in Host on GitHub Pages, the deloyment is done. üéâ Update website\r#\rAdd more contents in C:/myweb/Blogs/content/ folder, and then git push to Github repository. Github Action will automaticaly update new contents in https://huilin-li.github.io/Blogs/.\nReferences\r#\rHow to install chocolatey in Windows Hugo with Git Hub Pages on Windows Using GitHub Pages with Actions to deploy Hugo sites in seconds - Tommy Byrd // HugoConf 2022 Hugo Book Theme Host on GitHub Pages „ÄêHugo„Äëhugo-book‰∏ªÈ¢ò‰ΩøÁî® Thanks!\r#\rReally appreciate your time for reading my blog, and bless you enjoy your day! If you have any suggestions or comments, please leave them below! (You don\u0026rsquo;t need to login to postüòâ, feel free to add posts.) "},{"id":2,"href":"/docs/me/","title":"Keep Things Simple","section":"Docs","content":"\rKeep Things Simple\r#\r"},{"id":3,"href":"/docs/blogs/bioworld/binderdesign/","title":"TP Binder Design","section":"Biology World","content":"\rBinder Design\r#\rIn this blog, I want to make notes on how I design the binder of the target protein using RFdiffusion, ProteinMPNN-FastRelax and so on.\nStep1:\r#\r"},{"id":4,"href":"/docs/blogs/bioworld/proteinstruture/","title":"4 levels of protein structure","section":"Biology World","content":"There are four levels of protein structure: primary, secondary, tertiary and quaternary.\nPrimary Structure.\r#\rA protein‚Äôs primary structure is the unique sequence of amino acids in each polypeptide chain that makes up the protein.\nfasta file sequence of 20 amino acids Secondary Structure\r#\rReference:\r#\r3.9: Proteins - Protein Structure Thanks!\r#\rReally appreciate your time for reading my blog, and bless you enjoy your day! If you have any suggestions or comments, please leave them below! (You don\u0026rsquo;t need to login to postüòâ, feel free to add posts.) "},{"id":5,"href":"/docs/blogs/hugo/","title":"Hugo","section":"Blog","content":"\rYour personal website\r#\rThe important reason of why I build this personal website is I want to share my experiences of learning and practicing knowledge and skills. I hope these experiences could help people and save their time a litte bit. Most importantly, this is a great place to share and record solutions to some annoying troubles. üôå\nAt this moment, I use Hugo + Github to build and matintain my personal website. Therefore, you will see how I build and add new features in this website under the framework of Hugo, how I solve troubles, what references I refer, and so on. Let\u0026rsquo;s keep things simple! You can get these following experiences here, and hope they woule be helpful to you!\nIn Windows 10, build personal website via Hugo-book theme and deploy the static website to github via Github Action. Some commands you might use when building a website: Insert images and resize images Add emoji Add a travel map Why my local website doesn\u0026rsquo;t update after I update my markdown files? Link to pages and titles Add a comment section Thanks!\r#\rReally appreciate your time for reading my blog, and bless you enjoy your day! If you have any suggestions or comments, please leave them below! (You don\u0026rsquo;t need to login to postüòâ, feel free to add posts.) "},{"id":6,"href":"/docs/blogs/hugo/hugo/","title":"Hugo Commands","section":"Hugo","content":"\rHow to insert images and resize images?\r#\rThe file tree is like\n‚îú‚îÄcontent\r‚îÇ ‚îÇ _index.md\r‚îÇ ‚îÇ\r‚îÇ ‚îî‚îÄdocs\r‚îÇ ‚îú‚îÄblogs\r‚îÇ ‚îÇ ‚îÇ hugo.md\r‚îÇ ‚îÇ ‚îÇ _index.md\r‚îÇ ‚îÇ ‚îÇ\r‚îÇ ‚îÇ ‚îî‚îÄimages\r‚îÇ ‚îÇ Nice.png In hugo.md file, we add Nice.png and scale it by\n{{\u0026lt; figure src=\u0026#34;../images/Nice.png\u0026#34; width=\u0026#34;400\u0026#34; alt=\u0026#34; \u0026#34; \u0026gt;}} Why we need to add ../ in front of images folder, altough hugo.md file and images folder are at the same level? Because Hugo system sees hugo.md as a foler too. However, Hugo system sees _index.md as a file! Therefore, If we want to insert iamges in _index.md file, the command will be like:\n{{\u0026lt; figure src=\u0026#34;./images/Nice.png\u0026#34; width=\u0026#34;400\u0026#34; alt=\u0026#34; \u0026#34; \u0026gt;}} How to add emoji?\r#\rDirectly copy emoji icon üëã and paste to .md file, instead of using :wave:.\nEmoji Cheat Sheet: https://github.com/ikatyang/emoji-cheat-sheet/blob/master/README.md\nHow to add a travel map in Hugo?\r#\rRefer to this article\nNOTE:\nIn {{\u0026lt; openstreetmap mapName=\u0026quot;\u0026lt;your map name\u0026gt;\u0026quot; \u0026gt;}}, the \u0026lt;your map name\u0026gt; is not the name you give to your map, but the name in the website link of your map. For example, I created a map whose name is Travel, I need to use travel_1036974 in the hugo shortcode. Why my local website doesn\u0026rsquo;t update after I update my markdown files?\r#\rGood question. I also find my local website does not update although I have save my changes. I am not clear the excat reason, but It works well if I Pree Ctrl+C to stop the local host, and hugo server again, I can see the updated website in http://localhost:1313/.\nHow to link pages and tiles?\r#\rI am in now.md file now, and there is another page.md which has #Title I want to link. I want to link to page.md and link to #Title I want to link. In page.md file, add an anchor:\n# Title I want to link {#anchor} In now.md file, add commands:\n[text] ( {{\u0026lt; ref \u0026#34;./pages.md\u0026#34; \u0026gt;}} ) # link to one page [text] ( {{\u0026lt; ref \u0026#34;./pages.md#anchor\u0026#34; \u0026gt;}} ) # link to the title I want to add a comment section (via Cactus Comments).\r#\rRegister a Matrix account via https://app.element.io/#/login. Login. register comments by The name we will use to add comment section is huilinBlog. Create and add chat.html. In my case, my root directory is Blogs/ and chat.html is added to Blogs/layouts/shortcodes/ in which shortcodes folder is also created by yourself. ‚îú‚îÄ.github\r‚îú‚îÄlayouts\r‚îÇ ‚îî‚îÄshortcodes\r‚îî‚îÄthemes\r‚îú‚îÄhugo-book\r‚îÇ ‚îú‚îÄ.github\r‚îÇ ‚îú‚îÄlayouts\r‚îÇ ‚îÇ ‚îú‚îÄshortcodes NOTE: Do not add chat.html to themes/layouts/shortcodes/, because we are not authorized to modify the the theme github via git push and so on.\nCopy the following and paste to chat.html, and replace \u0026lt;YOUR-SITE-NAME\u0026gt; with comments, like siteName: \u0026quot;comments\u0026quot;, \u0026lt;script type=\u0026#34;text/javascript\u0026#34; src=\u0026#34;https://latest.cactus.chat/cactus.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt;\r\u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://latest.cactus.chat/style.css\u0026#34; type=\u0026#34;text/css\u0026#34;\u0026gt;\r\u0026lt;div id=\u0026#34;comment-section\u0026#34;\u0026gt;\u0026lt;/div\u0026gt;\r\u0026lt;script\u0026gt;\rinitComments({\rnode: document.getElementById(\u0026#34;comment-section\u0026#34;),\rdefaultHomeserverUrl: \u0026#34;https://matrix.cactus.chat:8448\u0026#34;,\rserverName: \u0026#34;cactus.chat\u0026#34;,\rsiteName: \u0026#34;\u0026lt;YOUR-SITE-NAME\u0026gt;\u0026#34;,\rcommentSectionId: \u0026#34;{{ index .Params 0 }}\u0026#34;\r})\r\u0026lt;/script\u0026gt; Add the chat comment section to post. {{\u0026lt; chat cactus-comments \u0026gt;}} The cactus-comments is the name that will be shown in your cactus chat website. For example, my case {{\u0026lt; chat test \u0026gt;}}, so my cactus chat website is like\nLet us test! NOTE\nI am also trying other comment tools, and let\u0026rsquo;s see which one is more suitable.\rReferences\r#\rhugo book demo „ÄêHugo„Äëhugo-book‰∏ªÈ¢ò‰ΩøÁî® hugoÂçöÂÆ¢ ÊñáÂÜÖÊèíÂÖ•ÂõæÁâá How to render markdown url with .md to correct link Linking pages in Hugo/markdown Added Cactus Comments to Hugo Cactus Comments Thanks!\r#\rReally appreciate your time for reading my blog, and bless you enjoy your day! If you have any suggestions or comments, please leave them below! (You don\u0026rsquo;t need to login to postüòâ, feel free to add posts.) "},{"id":7,"href":"/docs/blogs/bioworld/preprocessing_for_binder/","title":"test","section":"Biology World","content":""},{"id":8,"href":"/docs/travel/","title":"World","section":"Docs","content":"\rWorld\r#\r"},{"id":9,"href":"/docs/blogs/shell/","title":"Shell Commands","section":"Blog","content":"\rShell Commands\r#\rHow to discard changes in VScode?\r#\rNavigate to reporsitory (has .github folder) with changes. Then, git restore \u0026lt;file\u0026gt; "},{"id":10,"href":"/docs/blogs/bioworld/preprocessing/","title":"Preprocessing","section":"Biology World","content":"\u003c!DOCTYPE html\u003e\rpreprocessing\rIn\u0026nbsp;[23]:\rfrom biopandas.pdb import PandasPdb\rfrom itertools import chain\rfrom Bio import PDB\rimport numpy as np\rimport pandas as pd\rimport plotly.express as px\rimport plotly.graph_objects as go\rfrom sklearn.cluster import KMeans\rimport warnings\rwarnings.simplefilter(action=\"ignore\")\r0. TOOLS\u0026#182;\rIn\u0026nbsp;[14]:\rdef residue_remove(pdbfile, remove_ids, outputName):\r\"\"\"\rAssumption: pdbfile only has A chain\r\"\"\"\rresidue_to_remove = []\rpdb_io = PDB.PDBIO()\rpdb_parser = PDB.PDBParser()\rstructure = pdb_parser.get_structure(\" \", pdbfile)\rmodel = structure[0]\rchain = model[\"A\"]\rfor residue in chain:\rid = residue.id\rif id[1] in remove_ids: residue_to_remove.append(residue.id)\rfor residue in residue_to_remove:\rchain.detach_child(residue)\rpdb_io.set_structure(structure)\rpdb_io.save(outputName)\rreturn In\u0026nbsp;[84]:\rdef update_resnum(pdbfile):\r\"\"\"\rüåü CHANGE RESIDUE NUMBER\rAssumption: pdbfile only has A chain\r\"\"\"\rpdb_io = PDB.PDBIO()\rpdb_parser = PDB.PDBParser()\rstructure = pdb_parser.get_structure(\" \", pdbfile)\rmodel = structure[0]\rchain = model[\"A\"]\rprint(len([i for i in chain.get_residues()]))\rnew_resnums = list(range(1, 1+len([i for i in chain.get_residues()])))\rfor i, residue in enumerate(chain.get_residues()):\rres_id = list(residue.id)\rres_id[1] = new_resnums[i]\rresidue.id = tuple(res_id)\rpdb_io.set_structure(structure)\rpdb_io.save(pdbfile.split('pdb')[0] + '_update_resnum.pdb')\rreturn\rIn\u0026nbsp;[\u0026nbsp;]:\rIn\u0026nbsp;[\u0026nbsp;]:\r1. Load target protein\u0026#182;\rIn\u0026nbsp;[2]:\rtarget_pdb = PandasPdb().read_pdb('./target/AF-Q9H1U9-F1-model_v4.pdb')\rIn\u0026nbsp;[4]:\rtarget_df = target_pdb.df['ATOM']\rtarget_df\rOut[4]:\rrecord_name\ratom_number\rblank_1\ratom_name\ralt_loc\rresidue_name\rblank_2\rchain_id\rresidue_number\rinsertion\r...\rx_coord\ry_coord\rz_coord\roccupancy\rb_factor\rblank_4\rsegment_id\relement_symbol\rcharge\rline_idx\r0\rATOM\r1\rN\rMET\rA\r1\r...\r50.382\r-9.024\r-50.566\r1.0\r35.97\rN\rNaN\r70\r1\rATOM\r2\rCA\rMET\rA\r1\r...\r50.276\r-7.868\r-51.476\r1.0\r35.97\rC\rNaN\r71\r2\rATOM\r3\rC\rMET\rA\r1\r...\r49.309\r-6.908\r-50.793\r1.0\r35.97\rC\rNaN\r72\r3\rATOM\r4\rCB\rMET\rA\r1\r...\r49.838\r-8.362\r-52.871\r1.0\r35.97\rC\rNaN\r73\r4\rATOM\r5\rO\rMET\rA\r1\r...\r48.126\r-7.209\r-50.783\r1.0\r35.97\rO\rNaN\r74\r...\r...\r...\r...\r...\r...\r...\r...\r...\r...\r...\r...\r...\r...\r...\r...\r...\r...\r...\r...\r...\r...\r2372\rATOM\r2373\rO\rILE\rA\r297\r...\r-0.792\r25.811\r-25.379\r1.0\r78.01\rO\rNaN\r2442\r2373\rATOM\r2374\rCG1\rILE\rA\r297\r...\r-3.634\r24.414\r-22.032\r1.0\r78.01\rC\rNaN\r2443\r2374\rATOM\r2375\rCG2\rILE\rA\r297\r...\r-1.337\r25.379\r-22.401\r1.0\r78.01\rC\rNaN\r2444\r2375\rATOM\r2376\rCD1\rILE\rA\r297\r...\r-3.337\r23.661\r-20.729\r1.0\r78.01\rC\rNaN\r2445\r2376\rATOM\r2377\rOXT\rILE\rA\r297\r...\r-1.741\r24.057\r-26.252\r1.0\r78.01\rO\rNaN\r2446\r2377 rows √ó 21 columns\nIn\u0026nbsp;[55]:\rtarget_df.nunique()\rOut[55]:\rrecord_name 1\ratom_number 2377\rblank_1 1\ratom_name 37\ralt_loc 1\rresidue_name 20\rblank_2 1\rchain_id 1\rresidue_number 297\rinsertion 1\rblank_3 1\rx_coord 2321\ry_coord 2306\rz_coord 2318\roccupancy 1\rb_factor 273\rblank_4 1\rsegment_id 1\relement_symbol 4\rcharge 0\rline_idx 2377\rdtype: int64\rIn\u0026nbsp;[61]:\rtarget_df.dtypes\rOut[61]:\rrecord_name object\ratom_number int32\rblank_1 object\ratom_name object\ralt_loc object\rresidue_name object\rblank_2 object\rchain_id object\rresidue_number int32\rinsertion object\rblank_3 object\rx_coord float64\ry_coord float64\rz_coord float64\roccupancy float64\rb_factor float64\rblank_4 object\rsegment_id object\relement_symbol object\rcharge float64\rline_idx int64\rdtype: object\r2. Truncate target protein\u0026#182;low pLDDT: 1-22\u0026#182;transmembrane: 36-56, 85-105, 116-135, 179-199, 215-235, 268-289\u0026#182;https://alphafold.ebi.ac.uk/entry/Q9H1U9\u0026#182;https://www.uniprot.org/uniprotkb/Q9H1U9/entry#subcellular_location\u0026#182;\rIn\u0026nbsp;[32]:\rtruncating_ids = list(range(1,23))+list(range(36,57))+list(range(85,106))+list(range(116,136))+list(range(179,200))+list(range(215,236))+list(range(268,290))\rIn\u0026nbsp;[56]:\r297 - 148\rOut[56]:\r149\rIn\u0026nbsp;[54]:\rlen(truncating_ids)\rOut[54]:\r148\rIn\u0026nbsp;[33]:\rresidue_remove(pdbfile=\"./target/AF-Q9H1U9-F1-model_v4.pdb\", remove_ids=truncating_ids, outputName=\"./target/truncation.pdb\")\rIn\u0026nbsp;[34]:\rtruncation = PandasPdb().read_pdb(\"./target/truncation.pdb\")\rcols = [\"atom_name\", \"residue_name\", \"residue_number\", \"x_coord\", \"y_coord\", \"z_coord\"]\rdf = truncation.df[\"ATOM\"][cols]\rdf\rOut[34]:\ratom_name\rresidue_name\rresidue_number\rx_coord\ry_coord\rz_coord\r0\rN\rPRO\r23\r16.691\r28.716\r-21.862\r1\rCA\rPRO\r23\r16.179\r28.381\r-20.521\r2\rC\rPRO\r23\r14.687\r28.705\r-20.310\r3\rCB\rPRO\r23\r17.085\r29.147\r-19.554\r4\rO\rPRO\r23\r14.032\r28.086\r-19.476\r...\r...\r...\r...\r...\r...\r...\r1236\rO\rILE\r297\r-0.792\r25.811\r-25.379\r1237\rCG1\rILE\r297\r-3.634\r24.414\r-22.032\r1238\rCG2\rILE\r297\r-1.337\r25.379\r-22.401\r1239\rCD1\rILE\r297\r-3.337\r23.661\r-20.729\r1240\rOXT\rILE\r297\r-1.741\r24.057\r-26.252\r1241 rows √ó 6 columns\nIn\u0026nbsp;[57]:\rlen(set(df['residue_number'].tolist()))\rOut[57]:\r149\rIn\u0026nbsp;[68]:\r# check: whether each resnum has one CB\rresnum = list(set(df['residue_number'].tolist()))\rCB_nan = []\ri = 0\rfor res in resnum:\rsub_df = df[df[\"residue_number\"]==res]\rif \"CB\" in sub_df[\"atom_name\"].tolist():\rpass\relse:\ri += 1\rCB_nan.append(res)\rprint(res)\rprint(\"i=\", i)\r29\r62\r76\r83\r168\r170\r175\r244\r245\ri= 9\rIn\u0026nbsp;[\u0026nbsp;]:\rIn\u0026nbsp;[\u0026nbsp;]:\r2. Visualize $fig$ truncation.pdb with only $C_{\\beta}$ ATOM\u0026#182;\rIn\u0026nbsp;[35]:\rdf_CB = df[df[\"atom_name\"]==\"CB\"]\rIn\u0026nbsp;[50]:\rlen(set(df_CB['residue_number'].tolist()))\rOut[50]:\r140\rIn\u0026nbsp;[36]:\rfig = go.Figure(data =[go.Scatter3d(x = df_CB['x_coord'],\ry = df_CB['y_coord'],\rz = df_CB['z_coord'],\rmode ='markers')])\rfig.update_traces(marker_size=10)\rfig.update_layout(\rwidth = 1100, height=1100\r)\rfig.update_layout(margin=dict(l=0, r=0, b=0, t=0))\rfig.update_layout(scene=dict(\rxaxis_title='x coord',\ryaxis_title='y coord',\rzaxis_title='z coord'\r))\rfig.show()\r3. Grouping into 2 parts using clustering for separately desiging binders for each part\u0026#182;when observing 3D plot, we can see there are 2 clear distinguishing parts\u0026#182;\rIn\u0026nbsp;[37]:\rx = df_CB[['x_coord', 'y_coord', 'z_coord']].values\rmodel = KMeans(n_clusters = 2, init = \"k-means++\", max_iter = 300, n_init = 10, random_state = 0)\ry_clusters = model.fit_predict(x)\rdf_CB['label'] = [str(i) for i in y_clusters]\rdf_CB\rOut[37]:\ratom_name\rresidue_name\rresidue_number\rx_coord\ry_coord\rz_coord\rlabel\r3\rCB\rPRO\r23\r17.085\r29.147\r-19.554\r1\r10\rCB\rHIS\r24\r12.505\r31.513\r-21.284\r1\r20\rCB\rILE\r25\r11.779\r27.657\r-25.057\r1\r28\rCB\rTHR\r26\r13.504\r24.063\r-21.142\r1\r35\rCB\rASN\r27\r11.041\r27.148\r-17.728\r1\r...\r...\r...\r...\r...\r...\r...\r...\r1203\rCB\rLEU\r293\r-5.104\r19.547\r-21.490\r1\r1211\rCB\rLEU\r294\r-1.227\r18.292\r-25.069\r1\r1219\rCB\rLYS\r295\r-4.821\r19.749\r-28.811\r1\r1228\rCB\rVAL\r296\r-7.003\r23.205\r-25.432\r1\r1235\rCB\rILE\r297\r-2.436\r24.489\r-23.013\r1\r140 rows √ó 7 columns\nIn\u0026nbsp;[38]:\r# cluster visualization\rfig2 = px.scatter_3d(df_CB, x='x_coord', y='y_coord', z='z_coord', color='label')\rfig2.update_traces(marker_size=10)\rfig2.update_layout(\rwidth = 1100, height= 1100\r)\rfig2.show()\r4. Get transmembrane outside and inside protein pdb\u0026#182;outside and inside protein residue number\u0026#182;\rIn\u0026nbsp;[64]:\rout_resnum = df_CB[df_CB['label'] == '0']['residue_number'].tolist()\rin_resnum = df_CB[df_CB['label'] == '1']['residue_number'].tolist()\rIn\u0026nbsp;[66]:\rlen(out_resnum), len(in_resnum) # =140\rOut[66]:\r(95, 45)\rIn\u0026nbsp;[67]:\rlen(set(out_resnum)), len(set(in_resnum))\rOut[67]:\r(95, 45)\routside_pdb and inside_pdb\u0026#182;\rIn\u0026nbsp;[81]:\r## OUTSIDE PROTEIN - label0\rresidue_remove(pdbfile=\"./target/truncation.pdb\", remove_ids=in_resnum+CB_nan, outputName=\"./target/outside.pdb\")\r## INSIDE PROTEIN - label1\rresidue_remove(pdbfile=\"./target/truncation.pdb\", remove_ids=out_resnum+CB_nan, outputName=\"./target/inside.pdb\")\rIn\u0026nbsp;[70]:\r# for test\rop = PandasPdb().read_pdb(\"./target/outside.pdb\")\rip = PandasPdb().read_pdb(\"./target/inside.pdb\")\rlen(set(op.df['ATOM']['residue_number'])), len(set(ip.df['ATOM']['residue_number']))\rOut[70]:\r(95, 45)\r5. Replace residue numbers by continuous numbers \u0026#129516;\u0026#127775; CHANGE RESIDUE NUMBER\u0026#182;\rIn\u0026nbsp;[86]:\r## for whole update_resnum(pdbfile=\"./target/truncation.pdb\")\r## for outside part\rupdate_resnum(pdbfile=\"./target/outside.pdb\")\r## for inside part\rupdate_resnum(pdbfile=\"./target/inside.pdb\")\r149\r95\r45\r6. Select specifi AA position \u0026#129320; for only ouside_update_resnum.pdb\u0026#182;ref: https://www.sigmaaldrich.com/US/en/technical-documents/technical-article/protein-biology/protein-structural-analysis/amino-acid-reference-chart\u0026#182;ref: https://github.com/RosettaCommons/RFdiffusion\u0026#182;At pH $7^{B}$\u0026#182;\"In the paper we define a hotspot as a residue on the target protein which is within 10A Cbeta distance of the binder\"\u0026#182;\rCan I use AF2_multimer for validation? I found that use_multimer=True would help with the in\rsilico score.\rIn\u0026nbsp;[88]:\rvery_hydrohobic = list(map(str.upper,['Leu', 'Ile', 'Phe', 'Trp', 'Val', 'Met']))\rhydrohobic = list(map(str.upper,['Cys', 'Tyr', 'Ala']))\rneural = list(map(str.upper,['Thr', 'His', 'Gly', 'Ser', 'Gln']))\rhydrophilic = list(map(str.upper,['Arg', 'Lys', 'Asn', 'Glu', 'Pro', 'Asp']))\rIn\u0026nbsp;[99]:\routside = PandasPdb().read_pdb('./target/outside_update_resnum.pdb')\routdf = outside.df[\"ATOM\"][cols]\routdf_CB = outdf[outdf[\"atom_name\"]==\"CB\"]\routdf_CB\rOut[99]:\ratom_name\rresidue_name\rresidue_number\rx_coord\ry_coord\rz_coord\r3\rCB\rARG\r1\r-19.548\r0.117\r-0.729\r14\rCB\rGLN\r2\r-17.363\r-4.088\r-3.220\r23\rCB\rGLN\r3\r-12.863\r-2.928\r-0.537\r32\rCB\rLEU\r4\r-15.576\r-1.252\r3.533\r40\rCB\rTYR\r5\r-19.833\r-4.008\r3.599\r...\r...\r...\r...\r...\r...\r...\r800\rCB\rARG\r91\r-14.250\r-19.722\r5.362\r811\rCB\rLYS\r92\r-16.204\r-18.073\r0.034\r820\rCB\rLEU\r93\r-10.963\r-17.682\r-2.362\r828\rCB\rILE\r94\r-15.660\r-16.372\r-4.713\r836\rCB\rASN\r95\r-16.730\r-13.813\r-0.102\r95 rows √ó 6 columns\nIn\u0026nbsp;[98]:\r# # highlight very_hydrohobic aas\r# hyd = []\r# for res in outdf_CB['residue_name']:\r# if res in very_hydrohobic:\r# hyd.append('yes')\r# else:\r# hyd.append('no')\r# outdf_CB['hydrohobic'] = hyd\r# outdf_CB\rOut[98]:\ratom_name\rresidue_name\rresidue_number\rx_coord\ry_coord\rz_coord\rhydrohobic\r3\rCB\rARG\r1\r-19.548\r0.117\r-0.729\rno\r14\rCB\rGLN\r2\r-17.363\r-4.088\r-3.220\rno\r23\rCB\rGLN\r3\r-12.863\r-2.928\r-0.537\rno\r32\rCB\rLEU\r4\r-15.576\r-1.252\r3.533\ryes\r40\rCB\rTYR\r5\r-19.833\r-4.008\r3.599\rno\r...\r...\r...\r...\r...\r...\r...\r...\r800\rCB\rARG\r91\r-14.250\r-19.722\r5.362\rno\r811\rCB\rLYS\r92\r-16.204\r-18.073\r0.034\rno\r820\rCB\rLEU\r93\r-10.963\r-17.682\r-2.362\ryes\r828\rCB\rILE\r94\r-15.660\r-16.372\r-4.713\ryes\r836\rCB\rASN\r95\r-16.730\r-13.813\r-0.102\rno\r95 rows √ó 7 columns\nIn\u0026nbsp;[\u0026nbsp;]:\rIn\u0026nbsp;[106]:\rvery_hydrohobic_df=outdf_CB[outdf_CB['residue_name'].isin(very_hydrohobic)]\rfig2.add_trace(\rgo.Scatter3d(x=very_hydrohobic_df['x_coord'],\ry=very_hydrohobic_df['y_coord'],\rz=very_hydrohobic_df['z_coord'],\rmarker_color='yellow',\rmode='markers',\rtext=very_hydrohobic_df['residue_number'])\r)\rMake a PLANE!!!\u0026#182;\rIn\u0026nbsp;[112]:\rindf = df_CB[df_CB[\"label\"]==\"1\"]\r# group indf into 3\rx_tmp = indf[['x_coord', 'y_coord', 'z_coord']].values\rmodel_tmp = KMeans(n_clusters = 3, init = \"k-means++\", max_iter = 300, n_init = 10, random_state = 0)\ry_clusters_tmp = model_tmp.fit_predict(x_tmp)\rindf['new_label'] = [str(i) for i in y_clusters_tmp]\rindf\rOut[112]:\ratom_name\rresidue_name\rresidue_number\rx_coord\ry_coord\rz_coord\rlabel\rnew_label\r3\rCB\rPRO\r23\r17.085\r29.147\r-19.554\r1\r2\r10\rCB\rHIS\r24\r12.505\r31.513\r-21.284\r1\r2\r20\rCB\rILE\r25\r11.779\r27.657\r-25.057\r1\r2\r28\rCB\rTHR\r26\r13.504\r24.063\r-21.142\r1\r2\r35\rCB\rASN\r27\r11.041\r27.148\r-17.728\r1\r2\r43\rCB\rVAL\r28\r7.024\r27.884\r-21.446\r1\r2\r54\rCB\rGLU\r30\r8.863\r21.706\r-17.761\r1\r2\r63\rCB\rMET\r31\r5.113\r25.341\r-16.718\r1\r2\r71\rCB\rLYS\r32\r2.711\r23.394\r-21.240\r1\r2\r80\rCB\rHIS\r33\r4.251\r18.522\r-19.685\r1\r2\r90\rCB\rTYR\r34\r3.567\r20.605\r-14.724\r1\r2\r102\rCB\rLEU\r35\r-0.753\r23.104\r-16.417\r1\r2\r351\rCB\rSER\r106\r18.500\r11.449\r-8.501\r1\r1\r357\rCB\rCYS\r107\r21.394\r15.428\r-6.456\r1\r1\r363\rCB\rLEU\r108\r21.461\r12.740\r-1.872\r1\r1\r371\rCB\rLEU\r109\r21.727\r8.288\r-4.881\r1\r1\r379\rCB\rHIS\r110\r24.717\r10.963\r-8.408\r1\r1\r389\rCB\rLYS\r111\r26.869\r13.210\r-3.998\r1\r1\r398\rCB\rHIS\r112\r26.897\r8.996\r-1.128\r1\r1\r408\rCB\rVAL\r113\r26.298\r5.075\r-4.283\r1\r1\r415\rCB\rSER\r114\r31.134\r5.503\r-7.956\r1\r1\r421\rCB\rALA\r115\r28.049\r1.344\r-7.066\r1\r1\r783\rCB\rHIS\r200\r9.631\r-15.979\r-21.480\r1\r0\r793\rCB\rLEU\r201\r8.540\r-11.328\r-24.469\r1\r0\r801\rCB\rPRO\r202\r9.114\r-12.678\r-29.746\r1\r0\r808\rCB\rTHR\r203\r14.266\r-10.255\r-29.899\r1\r0\r815\rCB\rALA\r204\r10.330\r-5.888\r-29.445\r1\r0\r820\rCB\rTHR\r205\r12.613\r-6.650\r-34.949\r1\r0\r827\rCB\rTHR\r206\r8.150\r-3.883\r-35.371\r1\r0\r834\rCB\rHIS\r207\r7.471\r0.908\r-33.177\r1\r0\r844\rCB\rSER\r208\r3.723\r-2.988\r-33.536\r1\r0\r850\rCB\rALA\r209\r7.472\r-6.306\r-31.594\r1\r0\r855\rCB\rHIS\r210\r8.858\r-1.919\r-28.479\r1\r0\r865\rCB\rLEU\r211\r3.543\r-1.073\r-28.168\r1\r0\r873\rCB\rVAL\r212\r3.001\r-6.404\r-28.127\r1\r0\r880\rCB\rASN\r213\r7.657\r-6.659\r-25.452\r1\r0\r888\rCB\rASP\r214\r6.237\r-2.102\r-22.979\r1\r0\r1171\rCB\rTYR\r290\r-3.048\r13.904\r-21.003\r1\r2\r1183\rCB\rGLU\r291\r-4.532\r13.655\r-26.076\r1\r2\r1192\rCB\rPHE\r292\r-8.407\r17.019\r-24.753\r1\r2\r1203\rCB\rLEU\r293\r-5.104\r19.547\r-21.490\r1\r2\r1211\rCB\rLEU\r294\r-1.227\r18.292\r-25.069\r1\r2\r1219\rCB\rLYS\r295\r-4.821\r19.749\r-28.811\r1\r2\r1228\rCB\rVAL\r296\r-7.003\r23.205\r-25.432\r1\r2\r1235\rCB\rILE\r297\r-2.436\r24.489\r-23.013\r1\r2\rIn\u0026nbsp;[116]:\r# cluster visualization\rfig_tmp = px.scatter_3d(indf, x='x_coord', y='y_coord', z='z_coord', color='new_label')\rfig_tmp.update_traces(marker_size=10)\rfig_tmp.update_layout(\rwidth = 800, height= 800\r)\rfig_tmp.show()\rIn\u0026nbsp;[119]:\rx0, y0, z0 = indf[indf[\"new_label\"]==\"0\"][['x_coord', 'y_coord', 'z_coord']].mean().tolist()\rx1, y1, z1 = indf[indf[\"new_label\"]==\"1\"][['x_coord', 'y_coord', 'z_coord']].mean().tolist()\rx2, y2, z2 = indf[indf[\"new_label\"]==\"2\"][['x_coord', 'y_coord', 'z_coord']].mean().tolist()\rIn\u0026nbsp;[120]:\rfig2.add_trace(\rgo.Scatter3d(x=[x0],\ry=[y0],\rz=[z0],\rmarker_color='green')\r)\rfig2.add_trace(\rgo.Scatter3d(x=[x1],\ry=[y1],\rz=[z1],\rmarker_color='black')\r)\rfig2.add_trace(\rgo.Scatter3d(x=[x2],\ry=[y2],\rz=[z2],\rmarker_color='orange')\r)\rIn\u0026nbsp;[123]:\rpts =np.array([[x0, y0, z0],\r[x1, y1, z1],\r[x2, y2, z2]])\rx, y, z = pts.T\rfig2.add_trace(\rgo.Mesh3d(x=x, y=y, z=z, color='lightpink', opacity=0.50)\r)\rIn\u0026nbsp;[125]:\routdf = df_CB[df_CB[\"label\"]==\"0\"]\r# group outdf into 3\rx_tmp2 = outdf[['x_coord', 'y_coord', 'z_coord']].values\rmodel_tmp2 = KMeans(n_clusters = 3, init = \"k-means++\", max_iter = 300, n_init = 10, random_state = 0)\ry_clusters_tmp2 = model_tmp2.fit_predict(x_tmp2)\routdf['new_label2'] = [str(i) for i in y_clusters_tmp2]\routdf\rOut[125]:\ratom_name\rresidue_name\rresidue_number\rx_coord\ry_coord\rz_coord\rlabel\rnew_label2\r110\rCB\rARG\r57\r-19.548\r0.117\r-0.729\r0\r0\r121\rCB\rGLN\r58\r-17.363\r-4.088\r-3.220\r0\r0\r130\rCB\rGLN\r59\r-12.863\r-2.928\r-0.537\r0\r2\r139\rCB\rLEU\r60\r-15.576\r-1.252\r3.533\r0\r0\r147\rCB\rTYR\r61\r-19.833\r-4.008\r3.599\r0\r0\r...\r...\r...\r...\r...\r...\r...\r...\r...\r1127\rCB\rARG\r263\r-14.250\r-19.722\r5.362\r0\r2\r1138\rCB\rLYS\r264\r-16.204\r-18.073\r0.034\r0\r2\r1147\rCB\rLEU\r265\r-10.963\r-17.682\r-2.362\r0\r2\r1155\rCB\rILE\r266\r-15.660\r-16.372\r-4.713\r0\r2\r1163\rCB\rASN\r267\r-16.730\r-13.813\r-0.102\r0\r2\r95 rows √ó 8 columns\nIn\u0026nbsp;[126]:\r# cluster visualization\rfig_tmp2 = px.scatter_3d(outdf, x='x_coord', y='y_coord', z='z_coord', color='new_label2')\rfig_tmp2.update_traces(marker_size=10)\rfig_tmp2.update_layout(\rwidth = 800, height= 800\r)\rfig_tmp2.show()\rIn\u0026nbsp;[128]:\rx02, y02, z02 = outdf[outdf[\"new_label2\"]==\"0\"][['x_coord', 'y_coord', 'z_coord']].mean().tolist()\rx12, y12, z12 = outdf[outdf[\"new_label2\"]==\"1\"][['x_coord', 'y_coord', 'z_coord']].mean().tolist()\rx22, y22, z22 = outdf[outdf[\"new_label2\"]==\"2\"][['x_coord', 'y_coord', 'z_coord']].mean().tolist()\rIn\u0026nbsp;[129]:\rfig2.add_trace(\rgo.Scatter3d(x=[x02],\ry=[y02],\rz=[z02],\rmarker_color='green')\r)\rfig2.add_trace(\rgo.Scatter3d(x=[x12],\ry=[y12],\rz=[z12],\rmarker_color='black')\r)\rfig2.add_trace(\rgo.Scatter3d(x=[x22],\ry=[y22],\rz=[z22],\rmarker_color='orange')\r)\rIn\u0026nbsp;[132]:\rpts2 =np.array([[x02, y02, z02],\r[x12, y12, z12],\r[x22, y22, z22]])\rx2, y2, z2 = pts2.T\rfig2.add_trace(\rgo.Mesh3d(x=x2, y=y2, z=z2, color='lightgreen', opacity=0.50)\r)\rIn\u0026nbsp;[135]:\r# distance calculation\rdef dist_to_plane(p, p0, p1, p2):\ru = p1 - p0\rv = p2 - p0\r# vector normal to plane\rn = np.cross(u, v)\rn /= np.linalg.norm(n)\rp_ = p - p0\rdist_to_plane = np.dot(p_, n)\rreturn dist_to_plane\rIn\u0026nbsp;[155]:\routdf\rOut[155]:\ratom_name\rresidue_name\rresidue_number\rx_coord\ry_coord\rz_coord\rlabel\rnew_label2\r110\rCB\rARG\r57\r-19.548\r0.117\r-0.729\r0\r0\r121\rCB\rGLN\r58\r-17.363\r-4.088\r-3.220\r0\r0\r130\rCB\rGLN\r59\r-12.863\r-2.928\r-0.537\r0\r2\r139\rCB\rLEU\r60\r-15.576\r-1.252\r3.533\r0\r0\r147\rCB\rTYR\r61\r-19.833\r-4.008\r3.599\r0\r0\r...\r...\r...\r...\r...\r...\r...\r...\r...\r1127\rCB\rARG\r263\r-14.250\r-19.722\r5.362\r0\r2\r1138\rCB\rLYS\r264\r-16.204\r-18.073\r0.034\r0\r2\r1147\rCB\rLEU\r265\r-10.963\r-17.682\r-2.362\r0\r2\r1155\rCB\rILE\r266\r-15.660\r-16.372\r-4.713\r0\r2\r1163\rCB\rASN\r267\r-16.730\r-13.813\r-0.102\r0\r2\r95 rows √ó 8 columns\nIn\u0026nbsp;[170]:\rp0 = np.array([x02, y02, z02])\rp1 = np.array([x12, y12, z12])\rp2 = np.array([x22, y22, z22])\rdis_dic = pd.DataFrame(columns=[\"x_coord\",\"y_coord\", \"z_coord\", \"dis\"])\rdis_list, xl, yl, zl = [], [], [], []\rIn\u0026nbsp;[173]:\rp0 = np.array([x02, y02, z02])\rp1 = np.array([x12, y12, z12])\rp2 = np.array([x22, y22, z22])\rdis_dic = pd.DataFrame(columns=[\"x_coord\",\"y_coord\", \"z_coord\", \"dis\"])\rdis_list, xl, yl, zl = [], [], [], []\rdis_list, xl, yl, zl = [], [], [], []\rfor i in range(0, len(outdf)):\rp = np.array(outdf.iloc[i][['x_coord', 'y_coord', 'z_coord']].tolist())\rdis = dist_to_plane(p, p0, p1, p2)\rdis_list.append(dis)\rxl.append(outdf.iloc[i]['x_coord'].tolist())\ryl.append(outdf.iloc[i]['y_coord'].tolist())\rzl.append(outdf.iloc[i]['z_coord'].tolist())\rdis_dic[\"dis\"] = dis_list\rdis_dic[\"x_coord\"] = xl\rdis_dic[\"y_coord\"] = yl\rdis_dic[\"z_coord\"] = zl\rdis_dic[\"abs_dis\"] = dis_dic['dis'].abs()\rIn\u0026nbsp;[174]:\rdis_dic\rOut[174]:\rx_coord\ry_coord\rz_coord\rdis\rabs_dis\r0\r-19.548\r0.117\r-0.729\r1.589757\r1.589757\r1\r-17.363\r-4.088\r-3.220\r4.504881\r4.504881\r2\r-12.863\r-2.928\r-0.537\r5.043841\r5.043841\r3\r-15.576\r-1.252\r3.533\r0.321443\r0.321443\r4\r-19.833\r-4.008\r3.599\r-2.443185\r2.443185\r...\r...\r...\r...\r...\r...\r90\r-14.250\r-19.722\r5.362\r-2.013906\r2.013906\r91\r-16.204\r-18.073\r0.034\r1.312743\r1.312743\r92\r-10.963\r-17.682\r-2.362\r6.327248\r6.327248\r93\r-15.660\r-16.372\r-4.713\r5.622217\r5.622217\r94\r-16.730\r-13.813\r-0.102\r1.492185\r1.492185\r95 rows √ó 5 columns\nIn\u0026nbsp;[156]:\rdis_dic#.sort_values('abs_dis')\rOut[156]:\rresnum\rdis\rabs_dis\r0\r57\r1.589757\r1.589757\r1\r58\r4.504881\r4.504881\r2\r59\r5.043841\r5.043841\r3\r60\r0.321443\r0.321443\r4\r61\r-2.443185\r2.443185\r...\r...\r...\r...\r90\r263\r-2.013906\r2.013906\r91\r264\r1.312743\r1.312743\r92\r265\r6.327248\r6.327248\r93\r266\r5.622217\r5.622217\r94\r267\r1.492185\r1.492185\r95 rows √ó 3 columns\nIn\u0026nbsp;[157]:\routdf_CB\rOut[157]:\ratom_name\rresidue_name\rresidue_number\rx_coord\ry_coord\rz_coord\r3\rCB\rARG\r1\r-19.548\r0.117\r-0.729\r14\rCB\rGLN\r2\r-17.363\r-4.088\r-3.220\r23\rCB\rGLN\r3\r-12.863\r-2.928\r-0.537\r32\rCB\rLEU\r4\r-15.576\r-1.252\r3.533\r40\rCB\rTYR\r5\r-19.833\r-4.008\r3.599\r...\r...\r...\r...\r...\r...\r...\r800\rCB\rARG\r91\r-14.250\r-19.722\r5.362\r811\rCB\rLYS\r92\r-16.204\r-18.073\r0.034\r820\rCB\rLEU\r93\r-10.963\r-17.682\r-2.362\r828\rCB\rILE\r94\r-15.660\r-16.372\r-4.713\r836\rCB\rASN\r95\r-16.730\r-13.813\r-0.102\r95 rows √ó 6 columns\nIn\u0026nbsp;[175]:\rDF = pd.merge(outdf_CB, dis_dic, on=['x_coord', 'y_coord', 'z_coord'], how='inner')\rIn\u0026nbsp;[177]:\rDF.sort_values(\"abs_dis\")\rOut[177]:\ratom_name\rresidue_name\rresidue_number\rx_coord\ry_coord\rz_coord\rdis\rabs_dis\r61\rCB\rARG\r62\r-4.922\r3.598\r11.930\r0.126253\r0.126253\r78\rCB\rPRO\r79\r-2.725\r-12.217\r11.595\r0.281960\r0.281960\r3\rCB\rLEU\r4\r-15.576\r-1.252\r3.533\r0.321443\r0.321443\r45\rCB\rASN\r46\r-15.713\r18.835\r5.566\r0.360752\r0.360752\r67\rCB\rARG\r68\r-11.126\r-3.970\r7.312\r-0.397019\r0.397019\r...\r...\r...\r...\r...\r...\r...\r...\r...\r28\rCB\rGLU\r29\r-4.860\r6.760\r2.268\r8.265109\r8.265109\r73\rCB\rGLU\r74\r-7.086\r-2.624\r20.430\r-8.559560\r8.559560\r24\rCB\rILE\r25\r-13.981\r13.947\r-4.079\r8.746975\r8.746975\r27\rCB\rLEU\r28\r-4.346\r12.173\r2.220\r9.077787\r9.077787\r41\rCB\rASP\r42\r-24.109\r10.518\r11.755\r-10.251989\r10.251989\r95 rows √ó 8 columns\nIn\u0026nbsp;[\u0026nbsp;]:\r"}]